<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>客户</title>
	<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
	<meta name="format-detection" content="telephone=no" />
	<link rel="stylesheet" type="text/css" href="../../css/ui-base.css">
	<link rel="stylesheet" href="../../css/layer.css">
	<link rel="stylesheet" type="text/css" href="../../css/public.css">
	<link rel="stylesheet" type="text/css" href="../../css/pullToRefresh.css">
	<link rel="stylesheet" type="text/css" href="../../css/base_data.css">
</head>
<body class="uhide">
	<!--头部开始-->
	<header class="ub ub-pc ub-ac module-header-t1 line-b">
		<a class="goback ub ub-ac ub-pc" href="index.html">返回</a>
		<div class="ub-f1 ub ub-ac ub-pc">客户</div>
		<div class="holder"></div>
	</header>
	<!--头部结束-->
	<form class="ub module-input-t1 line-b" action="#" onsubmit="return false">
		<div class="ub-f1 ub ub-ac ub-pc line-all">
			<input type="text" maxlength="20" autocomplete="off" name="keyword" class="ub ub-f1" placeholder="名称/代码">
			<div class="search-icon"></div>
			<div class="focusShade _focusShade uhide"></div>
		</div>
	</form>
	<div id="wrapper">
		<ul class="list ub ub-ver bg-wh line-b line-t">
			<!-- 数据项-开始
			<li>
				<div class="listBody">
				    <ul class="messageContent um">
				        <li class="um">
				        	<div class="ub ub-ver line-b h-63" Data-href="client_detail.html?list_ID=1">
				        		<div class="ub ub-pj mart-10">
				        			<div class="ub-f1 ut-s tx-14 tx-bla marr-30"><span class="marr-10 tx-bla-2">K001</span><span class="tx-bla">北京天龙集团</span></div>
				        		</div>
				        		<div class="ub ub-ac  mart-10">
				        			<div class="mw-80 tx-12 tx-bla-3 marr-15 ut-s">一级客户</div>
									<div class="mw-100 tx-12 tx-bla-3 marr-15 ut-s">13800138000</div>
									<div class="ub-f1 tx-12 tx-bla-3 marr-15 ut-s">¥15000.00</div>
				        		</div>
				        	</div>
				        	<div class="btn-more"></div>
				        </li>
					    	        <li class="line-b ub ub-ver ub-ac ub-pc contact" data-href="tel:10010">
					            		<div class="phone-icon"></div>
					            		<div class="tx-14 tx-wh">电话</div>
					    	        </li>
					    	        <li class="line-b ub ub-ver ub-ac ub-pc contact" data-href="sms:110">
					            		<div class="message-icon"></div>
					            		<div class="tx-wh tx-14">短信</div>
					    	        </li>
				    </ul>
				</div>
			</li>
			数据项-结束
			数据项-开始
			<li>
				<div class="listBody">
				    <ul class="messageContent um">
				        <li class="um">
				        	<div class="ub ub-ver line-b h-63" Data-href="client_detail.html?list_ID=1">
				        		<div class="ub ub-pj mart-10">
				        			<div class="ub-f1 ut-s tx-14 tx-bla marr-30"><span class="marr-10 tx-bla-2">K001</span><span class="tx-bla">北京天龙集团</span></div>
				        		</div>
				        		<div class="ub ub-ac  mart-10">
				        			<div class="mw-80 tx-12 tx-bla-3 marr-15 ut-s">一级客户</div>
									<div class="mw-100 tx-12 tx-bla-3 marr-15 ut-s">13800138000</div>
									<div class="ub-f1 tx-12 tx-bla-3 marr-15 ut-s">¥15000.00</div>
				        		</div>
				        	</div>
				        	<div class="btn-more"></div>
				        </li>
					    	        <li class="line-b ub ub-ver ub-ac ub-pc contact" data-href="tel:''">
					            		<div class="phone-icon"></div>
					            		<div class="tx-14 tx-wh">电话</div>
					    	        </li>
					    	        <li class="line-b ub ub-ver ub-ac ub-pc contact" data-href="sms:110">
					            		<div class="message-icon"></div>
					            		<div class="tx-wh tx-14">短信</div>
					    	        </li>
				    </ul>
				</div>
			</li>
			数据项-结束
			数据项-开始
			<li>
				<div class="listBody">
				    <ul class="messageContent um">
				        <li class="um">
				        	<div class="ub ub-ver line-b h-63" Data-href="client_detail.html?list_ID=1">
				        		<div class="ub ub-pj mart-10">
				        			<div class="ub-f1 ut-s tx-14 tx-bla marr-30"><span class="marr-10 tx-bla-2">K001</span><span class="tx-bla">北京天龙集团</span></div>
				        		</div>
				        		<div class="ub ub-ac  mart-10">
				        			<div class="mw-80 tx-12 tx-bla-3 marr-15 ut-s">一级客户</div>
									<div class="mw-100 tx-12 tx-bla-3 marr-15 ut-s">13800138000</div>
									<div class="ub-f1 tx-12 tx-bla-3 marr-15 ut-s">¥15000.00</div>
				        		</div>
				        	</div>
				        	<div class="btn-more"></div>
				        </li>
					    	        <li class="line-b ub ub-ver ub-ac ub-pc contact" data-href="tel:10010">
					            		<div class="phone-icon"></div>
					            		<div class="tx-14 tx-wh">电话</div>
					    	        </li>
					    	        <li class="line-b ub ub-ver ub-ac ub-pc contact" data-href="sms:110">
					            		<div class="message-icon"></div>
					            		<div class="tx-wh tx-14">短信</div>
					    	        </li>
				    </ul>
				</div>
			</li>
			数据项-结束 -->
		</ul>
	</div>
</body>
<script type="text/javascript" src="../../js/sea.js"></script>
<script language="javascript">
//记录已打开的按钮对象
var former;
//数据列表
function dataListArray(){
	//存储获取的数据
	this.array=[];
	//发送的数据
	this.postData={};
	//请求方法
	this.requireData=function(){};
};
seajs.use(['zepto.min','public','base_data','layer','iscroll','pullToRefresh'],function(zepto,_Public,Base_data,layer){
	$('#wrapper').height($(window).height()-$('header').height()-$('form').height()-$('footer').height());
	//加载层
	var onload=layer.open({type: 2});
	//首次加载的数量
	var viewH=$(window).height()-$('header').height()-$('form').height()-$('footer').height();
	var nodeNumber=parseInt(viewH/63)+1;
	/*计算数据条的宽度，动态插入数据后-此段可以删去，已在enhance_data.js中写好-开始*/
    //$('.messageContent').width($(window).width()+120);
    //$('.messageContent').find(".um").width($(window).width()-30);
	/*计算数据条的宽度，动态插入数据后-此段可以删去，已在enhance_data.js中写好-结束*/
	//点击弹出more按钮
	Base_data.moreBtn();
	//拨打电话,发短信,点击查看客户详情
	Base_data.skipToHref('.contact,.h-63');
	/*输入框获得焦点时，背景虚化-开始*/
	$('.focusShade').width($(window).width()).height($(window).height());
	$('input').focus(function(){
		$('.focusShade').removeClass('uhide');
	});
	$('input').blur(function(){
		$('.focusShade').addClass('uhide');
	});
	/*输入框获得焦点时，背景虚化-结束*/
	refresher.init({
		id:"wrapper",
		pullDownAction:Refresh,
		pullUpAction:Load
	});
	//刷新
	function Refresh(){
		$('#pullUp,.pullUpLabel,.loader').css('display','block');
		dataListArray.postData.data.start=0;
		dataListArray.postData.data.pageSize=dataListArray.array.length;
		dataListArray.requireData(dataListArray.postData,'refresh');
		myScroll.refresh();
	};
	dataListArray.close=false;
	//上拉加载
	function Load(){
		if(dataListArray.close){
			$('#pullUp,.pullUpLabel,.loader').css('display','none');
		}else{
			dataListArray.postData.data.start=dataListArray.array.length;
			dataListArray.postData.data.pageSize=10;
			dataListArray.requireData(dataListArray.postData,'add');
		}
		myScroll.refresh();
	};
	/*数据交互-开始*/
	dataListArray.postData={
		url:"http://"+Base_data.sdip+"/common/client/clientList!doGetListData.action",
		method:'post',
		data:{
			pageSize:nodeNumber,
			start:'0',
		}
	};
	var displayvalue='K0001';
	var fieldid=['2000','2010','2020','2040','2050','2100','1822090','2170'];
	var fieldlabel=['客户编码','客户名称','地区','客户等级','往来类型','业务员','分支机构','联系人'];
	var fieldtype=['ft_Str','ft_ListStr','ft_Level','ft_ListNum','ft_Level','ft_ListStr','ft_ListStr','ft_ListStr'];
	var itemno=['0','1','2','3','4','5','6','7'];
	var operate=['或者','或者','或者（包含子级）','或者','或者','或者','或者','或者'];
	var realvalue="K0001";
	for(var i=0;i<8;i++){
		var num=String(i);
		dataListArray.postData.data["filterItems["+num+"].displayvalue"]=displayvalue;
		dataListArray.postData.data["filterItems["+num+"].fieldid"]=fieldid[i];
		dataListArray.postData.data["filterItems["+num+"].fieldlabel"]=fieldlabel[i];
		dataListArray.postData.data["filterItems["+num+"].fieldtype"]=fieldtype[i];
		dataListArray.postData.data["filterItems["+num+"].itemno"]=itemno[i];
		dataListArray.postData.data["filterItems["+num+"].operate"]=operate[i];
		dataListArray.postData.data["filterItems["+num+"].realvalue"]=realvalue;
	}
	dataListArray.requireData=function(postData,type){
		_Public.Get_ajax(postData,function(ret){
			layer.close(onload);
			var listData=ret.resultData.ListData?ret.resultData.ListData:[]; 
			if(listData.length==0){
				if(type=='first'){
					$('body').removeClass('uhide');
					$('#pullUp,.pullUpLabel,.loader').css('display','none');
					layer.open({
					    style: 'border:none; background-color:#78BA32; color:#fff;',
					    content:'数据为空...'
					})
				}else if(type=='add'){
					$('#pullUp,.pullUpLabel,.loader').css('display','none');
				}
				return;
			}
			if(ret.success){
				var node="";
				for(var i=0;i<listData.length;i++){
					var phone=listData[i].phone?listData[i].phone:'',
						moneycode=listData[i].moneycode,
						code=listData[i].code?listData[i].code:'',
						areaname=listData[i].areaname?listData[i].areaname:'',
						name=listData[i].name?listData[i].name:'',
						traderid=listData[i].traderid,
						levname=listData[i].levname?listData[i].levname:'',
						scamt=listData[i].scamt?listData[i].scamt:'0.00';
					node+='<li><div class="listBody"><ul class="messageContent um"><li class="um"><div class="ub ub-ver line-b h-63" Data-href="client_detail.html?list_id='+traderid+'&list_code='+code+'"><div class="ub ub-pj mart-10"><div class="ub-f1 ut-s tx-14 tx-bla marr-30"><span class="marr-10 tx-bla-2">'+code+'</span><span class="tx-bla">'+areaname+name+'</span></div></div><div class="ub ub-ac  mart-10"><div class="mw-80 tx-12 tx-bla-3 marr-15 ut-s">'+levname+'</div><div class="mw-100 tx-12 tx-bla-3 marr-15 ut-s">'+phone+'</div><div class="ub-f1 tx-12 tx-bla-3 marr-15 ut-s">'+moneycode+scamt+'</div></div></div><div class="btn-more"></div></li><li class="line-b ub ub-ver ub-ac ub-pc contact" data-href="tel:'+phone+'"><div class="phone-icon"></div><div class="tx-14 tx-wh">电话</div></li><li class="line-b ub ub-ver ub-ac ub-pc contact" data-href="sms:'+phone+'"><div class="message-icon"></div><div class="tx-wh tx-14">短信</div></li></ul></div></li>';
				}
				if(type=='refresh'||type=='search'){
					$('#wrapper .list').find('.listBody').remove();
					dataListArray.array=listData;
					
				}else if(type=='add'){
					dataListArray.array=dataListArray.array.concat(listData);
				}else{
					if(listData.length<nodeNumber){
						$('#pullUp,.pullUpLabel,.loader').css('display','none');
						dataListArray.close=true;
					}
					dataListArray.array=listData;
				}
				$('#wrapper .list').append(node);
			}
			$('body').removeClass('uhide');
		},function(err){
		});
	}
	dataListArray.requireData(dataListArray.postData);
	/*数据交互-结束*/
})
</script>
</html>